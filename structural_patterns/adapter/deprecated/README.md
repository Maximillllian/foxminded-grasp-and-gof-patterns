Это код владельца оригинального репозитория. Оставил его, потому что он сильно отличается от моего, возможно кому-то 
будет интересно посмотреть